 @model madurativas.db.mchat
<div class="modal-content">

    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
       
        <table class="col-md-12">

            <tr>
                <td class="col-md-6">

                    <h4 class="modal-title">
                        ¿@Model.estudio.Paciente.nombre hace movimientos raros con los dedos cerca de sus ojos?
                    </h4>
                </td>
                <td class="col-md-6">
                    <h4 style="color: red; float: right;"><strong>No es una prueba diagnóstica</strong></h4>
                </td>
            </tr>
        </table>
    </div>

    <div class="modal-body" id="bodyLenguaje">
        <div class="row">
            <div class="col-md-6">
                @using (@Html.BeginForm("SaveDetailQuest5", null, FormMethod.Post, new { id = "FrmQuest5" }))
                {
                    @Html.AntiForgeryToken()
                    <div class="form-horizontal">
                        <div class="form-group">
                            <label class="control-label col-md-8">
                                5- ¿@Model.estudio.Paciente.nombre hace movimientos raros con los dedos cerca de sus ojos?
                            </label>
                            <div class="col-md-4">
                                <div class="checkbox">
                                    @Html.CheckBox("quest_1", Convert.ToBoolean(Model.mchat_monitor_quest_5.quest1), new { @class = "form-control switch", @data_on_text = "Si", @data_off_text = "No" })
                                    @Html.ValidationMessageFor(model => model.mchat_monitor_quest_5.quest1, "", new { @class = "text-danger" })
                                </div>
                            </div>
                        </div>
                        <hr />
                        <div id="cuestionario" style="display: none;">
                            <div class="form-group">
                                <label class="control-label col-md-12" id="dt5_Observacion" style="display: none;">
                                    Por favor, describa estos movimientos (Si el padre/madre no da un PASA ejemplo de PASA o FALLA de los que están debajo, pregunte cada uno individualmente)
                                </label>
                            </div>
                            <hr />
                            <div class="form-group">
                                <label class="control-label col-md-12" id="dt5_lblEjemploPasa" >
                                    @string.Format("Alguna vez {0} … (Debajo hay ejemplos de PASA)", @Model.estudio.Paciente.nombre.Trim()).Trim()
                                </label>
                            </div>

                            <hr />
                            <div class="form-group">
                                <label class="control-label col-md-8">
                                    ¿Mira sus propias manos?
                                </label>
                                <div class="col-md-4">
                                    <div class="checkbox">
                                        @Html.CheckBox("quest_2", Convert.ToBoolean(Model.mchat_monitor_quest_5.quest2), new { @class = "form-control switch", @data_on_text = "Si", @data_off_text = "No" })
                                        @Html.ValidationMessageFor(model => model.mchat_monitor_quest_5.quest2, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="control-label col-md-8">
                                    ¿Mueve los dedos cuando juega a “¿adónde está el bebé?, ¡acá está!”?
                                </label>
                                <div class="col-md-4">
                                    <div class="checkbox">
                                        @Html.CheckBox("quest_3", Convert.ToBoolean(Model.mchat_monitor_quest_5.quest3), new { @class = "form-control switch", @data_on_text = "Si", @data_off_text = "No" })
                                        @Html.ValidationMessageFor(model => model.mchat_monitor_quest_5.quest3, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                            </div>
                            <hr />
                            <div class="form-group">
                                <label class="control-label col-md-12" id="dt5_lblEjemploFalla" >
                                    @string.Format("Alguna vez {0} … (Debajo hay ejemplos de FALLA)", @Model.estudio.Paciente.nombre.Trim()).Trim()
                                </label>
                            </div>

                            <hr />
                            <div class="form-group">
                                <label class="control-label col-md-8">
                                    ¿Mueve los dedos delante de sus ojos?
                                </label>
                                <div class="col-md-4">
                                    <div class="checkbox">
                                        @Html.CheckBox("quest_4", Convert.ToBoolean(Model.mchat_monitor_quest_5.quest4), new { @class = "form-control switch", @data_on_text = "Si", @data_off_text = "No" })
                                        @Html.ValidationMessageFor(model => model.mchat_monitor_quest_5.quest4, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="control-label col-md-8">
                                    ¿Pone las manos muy cerca de sus ojos?
                                </label>
                                <div class="col-md-4">
                                    <div class="checkbox">
                                        @Html.CheckBox("quest_5", Convert.ToBoolean(Model.mchat_monitor_quest_5.quest5), new { @class = "form-control switch", @data_on_text = "Si", @data_off_text = "No" })
                                        @Html.ValidationMessageFor(model => model.mchat_monitor_quest_5.quest5, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="control-label col-md-8">
                                    ¿Pone las manos al costado de sus ojos?
                                </label>
                                <div class="col-md-4">
                                    <div class="checkbox">
                                        @Html.CheckBox("quest_6", Convert.ToBoolean(Model.mchat_monitor_quest_5.quest6), new { @class = "form-control switch", @data_on_text = "Si", @data_off_text = "No" })
                                        @Html.ValidationMessageFor(model => model.mchat_monitor_quest_5.quest6, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="control-label col-md-8">
                                    ¿Aletea con las manos cerca de su cara?
                                </label>
                                <div class="col-md-4">
                                    <div class="checkbox">
                                        @Html.CheckBox("quest_7", Convert.ToBoolean(Model.mchat_monitor_quest_5.quest7), new { @class = "form-control switch", @data_on_text = "Si", @data_off_text = "No" })
                                        @Html.ValidationMessageFor(model => model.mchat_monitor_quest_5.quest7, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="control-label col-md-8">
                                    Otros
                                </label>
                                <div class="col-md-4">
                                    <div class="checkbox">
                                        @Html.CheckBox("quest_8", Convert.ToBoolean(Model.mchat_monitor_quest_5.quest8), new { @class = "form-control switch", @data_on_text = "Si", @data_off_text = "No" })
                                        @Html.ValidationMessageFor(model => model.mchat_monitor_quest_5.quest8, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                            </div>
                        </div>
                            <div class="form-group" id="divDescriba" style="display:none;">
                                <label class="control-label col-md-8">
                                    Describa:
                                </label>
                                <div class="col-md-4">

                                    @Html.EditorFor(model => model.mchat_monitor_quest_5.quest9, new { @class = "form-control" })
                                    @Html.ValidationMessageFor(model => model.mchat_monitor_quest_5.quest9, "", new { @class = "text-danger" })

                                </div>
                            </div>

                            <div class="form-group" id="divMasVeces" style="display:none;">
                                <label class="control-label col-md-8">
                                    Los ejemplos de FALLA ¿SE DAN MÁS DE 2 VECES POR SEMANA?
                                </label>
                                <div class="col-md-4">
                                    <div class="checkbox">
                                        @Html.CheckBox("quest_10", Convert.ToBoolean(Model.mchat_monitor_quest_5.quest10), new { @class = "form-control switch", @data_on_text = "Si", @data_off_text = "No" })
                                        @Html.ValidationMessageFor(model => model.mchat_monitor_quest_5.quest10, "", new { @class = "text-danger" })
                                    </div>
                                </div>
                            </div>

                            <hr />
                            <div class="form-group">
                                <label class="control-label col-md-8">
                                    Resultado de la Prueba:
                                </label>
                                <div class="col-md-4">
                                    <label class="control-label col-md-8" id="dt5lblResultado">
                                    </label>
                                </div>
                            </div>
                        </div>
                  
                }
            </div>
            <div class="col-md-6">
                <img src="@Url.Content("~/Content/images/quest5.png")" alt="img_quest5" />
            </div>
        </div>
    </div>

    <div class="modal-footer">
        <div class="form-group">
            <div class="col-md-12">
                <button id="btndtq5Save" type="submit" class="btn btn-primary" data-dismiss="modal">Guardar</button>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {

        var $dt5_quest1 = $('#FrmQuest5 #quest_1');
        var $dt5_quest2 = $('#FrmQuest5 #quest_2');
        var $dt5_quest3 = $('#FrmQuest5 #quest_3');
        var $dt5_quest4 = $('#FrmQuest5 #quest_4');
        var $dt5_quest5 = $('#FrmQuest5 #quest_5');
        var $dt5_quest6 = $('#FrmQuest5 #quest_6');
        var $dt5_quest7 = $('#FrmQuest5 #quest_7');
        var $dt5_quest8 = $('#FrmQuest5 #quest_8');
        var $dt5_quest9 = $('#FrmQuest5 #quest_9');
        var $dt5_quest10 = $('#FrmQuest5 #quest_10');

        var $dt5_cuestionario = $('#FrmQuest5 #cuestionario');
        var $dt5_Observacion = $('#FrmQuest5 #dt5_Observacion');
        var $dt5_lblEjemploFalla = $('#FrmQuest5 #dt5_lblEjemploFalla');
        var $dt5_lblEjemploPasa = $('#FrmQuest5 #dt5_lblEjemploPasa');
        var $dt5_Resultado = $('#dt5lblResultado');
        var $dt5_describa = $('#FrmQuest5 #divDescriba');
        var $dt5_divMasVeces = $('#FrmQuest5 #divMasVeces');



        if (!$dt5_quest1.is(':checked')) {
            resultado("Pasa");
            $dt5_cuestionario.hide()
            $dt5_Observacion.hide();
 

        } else {
            resultado("Falla");
            $dt5_cuestionario.show()
            $dt5_Observacion.show();
 
        }

        if (ValorEjemploFalla() < 4) {
            $dt5_divMasVeces.show();
        } else {
            $dt5_divMasVeces.hide();
        }

        function validaResultado() {

            if (!$dt5_quest1.is(":checked")) {
                resultado("Pasa");
            } else {
                resultado("Falla");
                
                if (ValorEjemploPasa() == 2) {
                    resultado("Pasa");

                } else {
                    resultado("Falla");
                }

                    if (ValorEjemploFalla() < 4) {
                        resultado("Falla");
                        if (!$dt5_quest10.is(':checked')) {
                            resultado("Pasa");
                        } else {
                            resultado("Falla");
                        }
                    } else {
                        resultado("Pasa");
                        
                    }

                
            }

            MuestraDescriptionSihayOtro()
            MuestraPreguntaSipasaMasdeDosVeces()

        }

        function MuestraDescriptionSihayOtro() {
            if ($dt5_quest8.is(':checked')) {
                $dt5_describa.show();
            } else {
                $dt5_describa.hide();
            }
        }

        function MuestraPreguntaSipasaMasdeDosVeces() {
            if (ValorEjemploFalla() < 4) {
                $dt5_divMasVeces.show();
            } else {
                $dt5_divMasVeces.hide();
            }

        }

        function resultado(valor) {
            $dt5_Resultado.empty();
            $dt5_Resultado.append(valor);
        }





        validaResultado();

        $('div.bootstrap-switch-container > span').click(function () {

            if ($dt5_quest1.is(':checked')) {
                $('#FrmQuest5 #cuestionario').show();
                $dt5_cuestionario.show()
                $dt5_Observacion.show();
                $dt5_lblEjemploPasa.show();


            } else {
                $('#FrmQuest5 #cuestionario').hide();
                $dt5_cuestionario.hide()
                $dt5_Observacion.hide();
                $dt5_lblEjemploPasa.hide();

                //$dt5_Observacion.hide();
            }

            MuestraDescriptionSihayOtro()
 
            
    

            MuestraPreguntaSipasaMasdeDosVeces()

            validaResultado();

        });


        function ValorEjemploPasa() {
            var nPasa = 0;

            if ($dt5_quest2.is(':checked')) nPasa++;
            if ($dt5_quest3.is(':checked')) nPasa++;
            
            return nPasa;

        }


        function ValorEjemploFalla() {
            var nFalla = 0;

            if (!$dt5_quest4.is(':checked')) nFalla++;
            if (!$dt5_quest5.is(':checked')) nFalla++;
            if (!$dt5_quest6.is(':checked')) nFalla++;
            if (!$dt5_quest7.is(':checked')) nFalla++;
           

            return nFalla;

        }


        $("#btndtq5Save").click(function (e) {

            e.preventDefault();

            var form = $("#FrmQuest5");

            var _pasa;
            if ($dt5_Resultado.text().toLowerCase() == "pasa") {
                _pasa = true;
            } else { _pasa = false; } 

            var q5datos = {
                estudioId: $("#estudio_id").val(),
                quest1: $dt5_quest1.is(":checked"),
                quest2: $dt5_quest2.is(":checked"),
                quest3: $dt5_quest3.is(":checked"),
                quest4: $dt5_quest4.is(":checked"),
                quest5: $dt5_quest5.is(":checked"),
                quest6: $dt5_quest6.is(":checked"),
                quest7: $dt5_quest7.is(":checked"),
                quest8: $dt5_quest8.is(":checked"),
                quest9: $dt5_quest9.val(),
                quest10: $dt5_quest10.is(":checked"),
                pasa: _pasa
            };

            $.ajax({
                url: form.attr("action"),
                method: form.attr("method"),
                data: q5datos
            });

        });

    });
</script>
